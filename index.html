<!DOCTYPE html> <html lang="zh-Hant"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1"> <title>EMS排班助手</title> <style> body { font-family: 'Segoe UI', Arial, sans-serif; margin: 0; background: #f7f7f7; color: #333; } header { background: #2c3e50; color: #fff; padding: 1rem; text-align: center; } nav { background: #34495e; color: #fff; padding: 0.5rem 1rem; display: flex; justify-content: space-between; align-items: center; } nav a { color: #fff; text-decoration: none; margin-right: 1rem; } .container { max-width: 900px; margin: 2rem auto; background: #fff; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); padding: 2rem; } .search-bar { display: flex; align-items: center; margin-bottom: 1rem; } .search-bar input { flex: 1; padding: 0.5rem; font-size: 1rem; border: 1px solid #ccc; border-radius: 4px; } .search-bar button { margin-left: 0.5rem; padding: 0.5rem 1rem; font-size: 1rem; background: #2980b9; color: #fff; border: none; border-radius: 4px; cursor: pointer; } .calendar-controls { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; } .calendar-controls button { background: #27ae60; color: #fff; border: none; border-radius: 4px; padding: 0.3rem 0.8rem; cursor: pointer; font-size: 1rem; } .calendar { width: 100%; border-collapse: collapse; margin-bottom: 1rem; } .calendar th, .calendar td { width: 14.28%; height: 70px; text-align: center; vertical-align: top; border: 1px solid #e1e1e1; position: relative; font-size: 0.95rem; background: #fff; } .calendar th { background: #ecf0f1; font-weight: bold; } .sat { background: #d6eaf8 !important; } .sun { background: #f9e79f !important; } .holiday { background: #f5b7b1 !important; } .highlight { border: 2px solid #e67e22 !important; box-shadow: 0 0 8px #e67e22; } .duty { font-size: 0.85em; color: #2980b9; margin-top: 0.2em; display: block; } .today { background: #abebc6 !important; font-weight: bold; } .edit-duty { margin-top: 0.5em; font-size: 0.85em; color: #e67e22; cursor: pointer; text-decoration: underline; } .note { margin-top: 2rem; font-size: 0.95em; color: #666; background: #f9f9f9; border-radius: 6px; padding: 1rem; border: 1px solid #eee; } /* 新增：橫式週排班表格樣式 */ .weekly-duty-table { width: 100%; border-collapse: collapse; margin-top: 1.5rem; font-size: 1rem; font-family: 'Segoe UI', Arial, sans-serif; } .weekly-duty-table th { background: #2c3e50; color: #fff; font-weight: bold; padding: 0.7em 0.2em; border: 1px solid #e1e1e1; font-size: 1.05em; } .weekly-duty-table td { border: 1px solid #e1e1e1; padding: 0.7em 0.2em; text-align: center; background: #fff; color: #333; } .weekly-duty-table .sat { background: #d6eaf8; } .weekly-duty-table .sun { background: #f9e79f; } .weekly-duty-table .holiday { background: #f5b7b1; } .weekly-duty-table .today { background: #abebc6; font-weight: bold; } /* 新增：Notes圖示樣式 */ .notes-icon { position: absolute; right: 0.5em; top: -2.2em; z-index: 10; cursor: pointer; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; transition: background 0.2s; border-radius: 50%; } .notes-icon:hover { background: #e1e1e1; } .notes-icon svg { width: 24px; height: 24px; fill: #2c3e50; transition: fill 0.2s; } .notes-icon:hover svg { fill: #e67e22; } /* 讓週表區塊相對定位，方便放icon */ #weeklyDutyTable { position: relative; } @media (max-width: 600px) { .container { padding: 0.5rem; } .calendar th, .calendar td { height: 40px; font-size: 0.8rem; } .search-bar input, .search-bar button { font-size: 0.9rem; } .note { font-size: 0.85em; padding: 0.5rem; } .weekly-duty-table th, .weekly-duty-table td { font-size: 0.85em; padding: 0.4em 0.1em; } .notes-icon { width: 28px; height: 28px; top: -2em; } .notes-icon svg { width: 20px; height: 20px; } } </style> </head> <body> <header> <h1>EMS排班助手</h1> </header> <nav> <div> <!-- 已移除首頁、排班月曆，只剩成員管理 --> <a href="#" id="memberManageBtn">成員管理</a> </div> <div> <span id="dutyInfo">2026/1/17 侑憲</span> <span class="edit-duty" onclick="editDutyDate()">調整</span> </div> </nav> <div class="container"> <div class="search-bar"> <input type="text" id="searchInput" placeholder="輸入人名查詢排班日期..."> <button onclick="searchDuty()">查詢</button> </div> <div class="calendar-controls"> <button onclick="prevMonth()">上一月</button> <span id="monthLabel"></span> <button onclick="nextMonth()">下一月</button> </div> <table class="calendar" id="calendarTable"></table> <div id="searchResult"></div> <!-- 備註區塊 --> <div class="note"> <b>備註：</b><br> 1. 只抓的到國定假日，抓不到補班日，所以2026以後的補班日要手動填『台灣國定假日』<br> 2. 年假天數非固定，要等行政院公告後再手動修改『// 春節連假』<br> 3. 排班人員有變更時，搜尋『排班人員區間設定』可直接修改 </div> <!-- 新增：橫式週排班表格 --> <div id="weeklyDutyTable"></div> </div> <!-- 彈窗調整排班起始日 --> <div id="editDutyModal" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.3);z-index:999;"> <div style="background:#fff;padding:2rem;border-radius:8px;max-width:350px;margin:10vh auto;box-shadow:0 2px 8px #333;"> <h3>調整排班起始日</h3> <label>日期：<input type="date" id="editDutyDate"></label><br><br> <label>值班人員： <select id="editDutyPerson"></select> </label><br><br> <button onclick="saveDutyDate()">儲存</button> <button onclick="closeEditDutyModal()">取消</button> </div> </div> <!-- 新增：成員管理彈窗 --> <div id="memberModal" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.3);z-index:1000;"> <div style="background:#fff;padding:2rem 2.5rem;border-radius:12px;max-width:420px;margin:10vh auto;box-shadow:0 2px 12px #333;position:relative;"> <h2 style="margin-top:0;text-align:center;color:#2c3e50;">成員排班表</h2> <table style="width:100%;border-collapse:collapse;margin:1.5em 0;"> <thead> <tr style="background:#34495e;color:#fff;"> <th style="padding:0.7em;border-radius:6px 0 0 0;">順序</th> <th style="padding:0.7em;">人名</th> <th style="padding:0.7em;border-radius:0 6px 0 0;">電話</th> </tr> </thead> <tbody> <tr style="background:#f7f7f7;"> <td>No.1</td><td>張智寬</td><td>8625050</td> </tr> <tr> <td>No.2</td><td>陳建翰</td><td>8623821</td> </tr> <tr style="background:#f7f7f7;"> <td>No.3</td><td>王靖凱</td><td>8623820</td> </tr> <tr> <td>No.4</td><td>郭宗宜</td><td>8623807</td> </tr> <tr style="background:#f7f7f7;"> <td>No.5</td><td>蔡侑憲</td><td>8623804</td> </tr> <tr> <td>No.6</td><td>陳桂豪</td><td>8625056</td> </tr> <tr style="background:#f7f7f7;"> <td>No.7</td><td>鄭天翔</td><td>8623819</td> </tr> <tr> <td>No.8</td><td>陳繹全</td><td>8623812</td> </tr> </tbody> </table> <button onclick="closeMemberModal()" style="display:block;margin:0 auto 0.5em auto;padding:0.5em 2em;background:#2980b9;color:#fff;border:none;border-radius:6px;font-size:1.1em;cursor:pointer;">關閉</button> </div> </div> <script> // ====== 1. 排班人員區間設定（可直接修改） ====== 
const memberPeriods = [ { start: '2025-12-18', end: '2026-02-28', members: ['智寬', '建翰', '靖凱', '宗宜', '侑憲', '桂豪', '天翔', '繹全'] }, { start: '2026-03-01', end: '2026-12-31', members: ['智寬', '建翰', '靖凱', '宗宜', '侑憲', '桂豪', '天翔', '繹全'] } ];
  // 人名與電話對照 
const memberPhones = { '靖凱': '8623820', '侑憲': '8623804', '建翰': '8623821', '智寬': '8625050', '宗宜': '8623807', '桂豪': '8625056', '天翔': '8623819', '繹全': '8623812' }; // ===== 新增：人名對全名 ===== 
const memberFullNames = { '靖凱': '王靖凱', '侑憲': '蔡侑憲', '建翰': '陳建翰', '智寬': '張智寬', '宗宜': '郭宗宜', '桂豪': '陳桂豪', '天翔': '鄭天翔', '繹全': '陳繹全' }; 
  // 春節連假值班人員設定（可直接修改） 
const springFestivalDuty = { '2026-02-16': '抽籤', '2026-02-17': '抽籤', '2026-02-18': '抽籤', '2026-02-19': '抽籤', '2026-02-20': '抽籤', }; 
  // 依日期取得成員名單 
function getMembersByDate(dateStr) { for (let period of memberPeriods) { if (dateStr >= period.start && dateStr <= period.end) { return period.members; } } return memberPeriods[0].members; } // ====== 2. 其他原有設定 ====== 
let dutyStartDate = '2026-01-17'; let dutyStartPerson = '侑憲'; 
  // 台灣國定假日 
  const holidays = [ { date: '2025-01-01', name: '元旦' }, { date: '2025-02-28', name: '和平紀念日' }, { date: '2025-04-04', name: '兒童節' }, { date: '2025-04-05', name: '清明節' }, { date: '2025-05-01', name: '勞動節' }, { date: '2025-05-31', name: '端午節' }, { date: '2025-09-28', name: '教師節' }, { date: '2025-10-06', name: '中秋節' }, { date: '2025-10-10', name: '國慶日' }, { date: '2025-10-25', name: '光復節' }, { date: '2025-12-25', name: '行憲紀念日' }, { date: '2026-01-01', name: '元旦' }, { date: '2026-02-27', name: '補假' }, { date: '2026-02-28', name: '和平紀念日' }, { date: '2026-04-03', name: '補假' }, { date: '2026-04-04', name: '兒童節' }, { date: '2026-04-05', name: '清明節' }, { date: '2026-04-06', name: '補假' }, { date: '2026-05-01', name: '勞動節' }, { date: '2026-06-19', name: '端午節' }, { date: '2026-09-25', name: '中秋節' }, { date: '2026-09-28', name: '教師節' }, { date: '2026-10-09', name: '補假' }, { date: '2026-10-10', name: '國慶日' }, { date: '2026-10-25', name: '光復節' }, { date: '2026-10-26', name: '補假' }, { date: '2026-12-25', name: '行憲紀念日' }, { date: '2030-01-01', name: '元旦' }, { date: '2030-02-28', name: '和平紀念日' }, { date: '2030-04-04', name: '兒童節' }, { date: '2030-04-05', name: '清明節' }, { date: '2030-05-01', name: '勞動節' }, { date: '2030-06-06', name: '端午節' }, { date: '2030-09-28', name: '教師節' }, { date: '2030-09-12', name: '中秋節' }, { date: '2030-10-10', name: '國慶日' }, { date: '2030-10-25', name: '光復節' }, { date: '2030-12-25', name: '行憲紀念日' }, ]; 
  // 春節連假 (2026/2/14~2/21) 
  const springFestival = [ '2026-02-14','2026-02-15','2026-02-16','2026-02-17','2026-02-18','2026-02-19','2026-02-20','2026-02-21' ]; let today = new Date(); let currentYear = today.getFullYear(); let currentMonth = today.getMonth() + 1; let searchName = ''; document.addEventListener('DOMContentLoaded', () => { renderMonthLabel(); renderCalendar(); fillEditDutyModal(); updateDutyInfo(); renderWeeklyDutyTable(); 
// 新增：渲染橫式週排班表 // 新增：成員管理按鈕事件 
                                                                                                                                                                                                                                                                                                                        document.getElementById('memberManageBtn').addEventListener('click', function(e){ e.preventDefault(); openMemberModal(); }); }); function renderMonthLabel() { document.getElementById('monthLabel').textContent = `${currentYear} 年 ${currentMonth} 月`; } function isHoliday(dateStr) { return holidays.find(h => h.date === dateStr); } function isSpringFestival(dateStr) { return springFestival.includes(dateStr); } function getDayType(date) { const day = date.getDay(); if (day === 6) return 'sat'; if (day === 0) return 'sun'; return ''; } function getDutyPerson(dateStr) { if (isSpringFestival(dateStr)) { if (springFestivalDuty[dateStr]) { return springFestivalDuty[dateStr]; } const d = new Date(dateStr); if (d.getDay() >= 1 && d.getDay() <= 5) return ''; } const d = new Date(dateStr); if (d.getDay() === 6) { const members = getMembersByDate(dateStr); const start = new Date(dutyStartDate); let diff = Math.round((d - start) / (1000 * 60 * 60 * 24 * 7)); const startMembers = getMembersByDate(dutyStartDate); let startIdx = startMembers.indexOf(dutyStartPerson); if (startIdx === -1) startIdx = 0; let idx = (startIdx + diff) % members.length; if (idx < 0) idx += members.length; return members[idx]; } if (d.getDay() === 0) { let sat = new Date(d); sat.setDate(d.getDate() - 8); return getDutyPerson(formatDate(sat)); } if (isHoliday(dateStr) && !isSpringFestival(dateStr)) { let sat = new Date(d); while (sat.getDay() !== 6) { sat.setDate(sat.getDate() - 1); } return getDutyPerson(formatDate(sat)); } return ''; } function formatDate(date) { let y = date.getFullYear(); let m = (date.getMonth() + 1).toString().padStart(2, '0'); let d = date.getDate().toString().padStart(2, '0'); return `${y}-${m}-${d}`; } function renderCalendar() { const table = document.getElementById('calendarTable'); table.innerHTML = ''; const days = ['日','一','二','三','四','五','六']; let thead = document.createElement('thead'); let tr = document.createElement('tr'); days.forEach(day => { let th = document.createElement('th'); th.textContent = day; tr.appendChild(th); }); thead.appendChild(tr); table.appendChild(thead); let firstDay = new Date(currentYear, currentMonth - 1, 1); let lastDay = new Date(currentYear, currentMonth, 0); let startDay = firstDay.getDay(); let totalDays = lastDay.getDate(); let tbody = document.createElement('tbody'); let row = document.createElement('tr'); for (let i = 0; i < startDay; i++) { row.appendChild(document.createElement('td')); } for (let date = 1; date <= totalDays; date++) { let d = new Date(currentYear, currentMonth - 1, date); let dateStr = formatDate(d); let td = document.createElement('td'); let type = getDayType(d); if (type) td.classList.add(type); if (isHoliday(dateStr)) td.classList.add('holiday'); if (isSpringFestival(dateStr)) td.classList.add('holiday'); if (formatDate(new Date()) === dateStr) td.classList.add('today'); if (searchName && getDutyPerson(dateStr) === searchName) td.classList.add('highlight'); td.innerHTML = `<div>${date}</div>`; let holiday = isHoliday(dateStr); if (holiday) { td.innerHTML += `<div style="color:#c0392b;font-size:0.8em;">${holiday.name}</div>`; } if (isSpringFestival(dateStr)) { td.innerHTML += `<div style="color:#c0392b;font-size:0.8em;">春節連假</div>`; } let person = getDutyPerson(dateStr); if (person) { td.innerHTML += `<span class="duty">${person}</span>`; } row.appendChild(td); if ((startDay + date) % 7 === 0 || date === totalDays) { tbody.appendChild(row); row = document.createElement('tr'); } } table.appendChild(tbody); } function prevMonth() { currentMonth--; if (currentMonth < 1) { currentMonth = 12; currentYear--; } renderMonthLabel(); renderCalendar(); } function nextMonth() { currentMonth++; if (currentMonth > 12) { currentMonth = 1; currentYear++; } renderMonthLabel(); renderCalendar(); } function searchDuty() { searchName = document.getElementById('searchInput').value.trim(); renderCalendar(); let result = []; let start = new Date(currentYear, 0, 1); let end = new Date(currentYear, 11, 31); for (let d = new Date(start); d <= end; d.setDate(d.getDate() + 1)) { let dateStr = formatDate(d); if (getDutyPerson(dateStr) === searchName) { result.push(dateStr); } } let div = document.getElementById('searchResult'); if (searchName && result.length) { div.innerHTML = `<b>${searchName} 排班日期：</b><br>${result.join(', ')}`; } else if (searchName) { div.innerHTML = `<b>${searchName} 無排班紀錄</b>`; } else { div.innerHTML = ''; } }
function fillEditDutyModal() { let sel = document.getElementById('editDutyPerson'); sel.innerHTML = ''; const members = getMembersByDate(dutyStartDate); members.forEach(m => { let opt = document.createElement('option'); opt.value = m; opt.textContent = m; sel.appendChild(opt); }); sel.value = dutyStartPerson; } function editDutyDate() { document.getElementById('editDutyModal').style.display = 'block'; document.getElementById('editDutyDate').value = dutyStartDate; fillEditDutyModal(); document.getElementById('editDutyPerson').value = dutyStartPerson; } function closeEditDutyModal() { document.getElementById('editDutyModal').style.display = 'none'; } function saveDutyDate() { let date = document.getElementById('editDutyDate').value; let person = document.getElementById('editDutyPerson').value; if (date && person) { dutyStartDate = date; dutyStartPerson = person; updateDutyInfo(); closeEditDutyModal(); renderCalendar(); renderWeeklyDutyTable(); // 新增：同步更新週表 } } function updateDutyInfo() { document.getElementById('dutyInfo').textContent = `${dutyStartDate.replace(/-/g,'/')} ${dutyStartPerson}`; } // ====== 新增：橫式週排班表格 ====== function renderWeeklyDutyTable() { // 取得「今天」往後的下一個週六 let now = new Date(); now.setHours(0,0,0,0); let sat = new Date(now); while (sat.getDay() !== 6) { sat.setDate(sat.getDate() + 1); } // 週六~週五 let dates = []; for (let i = 0; i < 7; i++) { let d = new Date(sat); d.setDate(sat.getDate() + i); dates.push(new Date(d)); } // 取得週六排班人員 let satStr = formatDate(dates[0]); let satPerson = getDutyPerson(satStr); // 產生表格 let days = ['週六','週日','週一','週二','週三','週四','週五']; let html = `<table class="weekly-duty-table"><thead><tr>`; days.forEach(day => html += `<th>${day}</th>`); html += `</tr></thead><tbody><tr>`; dates.forEach((d, idx) => { let dateStr = formatDate(d); let person = getDutyPerson(dateStr); if (!person) person = satPerson; // 若無排班人員則填週六人名 let fullName = memberFullNames[person] || person; // 這裡顯示全名 let phone = memberPhones[person] || ''; let type = ''; if (d.getDay() === 6) type = 'sat'; else if (d.getDay() === 0) type = 'sun'; if (isHoliday(dateStr)) type = 'holiday'; if (formatDate(new Date()) === dateStr) type += ' today'; html += `<td class="${type}"><div>${dateStr}</div><div>${fullName}</div><div style="font-size:0.95em;color:#2980b9;">${phone}</div></td>`; }); html += `</tr></tbody></table>`; // 新增：Notes圖示按鈕 html += ` <div class="notes-icon" title="Notes" onclick="window.open('Notes://F12AD16/48257DB0002E2D30/EF9C1CE35692F71348256C5C0034F18C/8B6DF6C88DEC5705482580EB00219DD1')"> <svg viewBox="0 0 24 24"> <path d="M4 4h16v16H4V4zm2 2v12h12V6H6zm2 2h8v2H8V8zm0 4h8v2H8v-2zm0 4h5v2H8v-2z"/> </svg> </div> `; document.getElementById('weeklyDutyTable').innerHTML = html; } // ===== 新增：成員管理彈窗開關 ===== function openMemberModal() { document.getElementById('memberModal').style.display = 'block'; } function closeMemberModal() { document.getElementById('memberModal').style.display = 'none'; } </script> </body> </html>
        
